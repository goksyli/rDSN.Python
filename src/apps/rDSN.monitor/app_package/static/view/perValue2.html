{% extends "static/view/template.html" %}
{% block body %}
{% include "static/view/head.html" %}
<div id="chart"></div>
<script>
var chart = c3.generate({
    data: {
        x: 'x',
        columns: [
            ['x' {% for i in range(20) %}, {{i}}{% endfor %} ],
	        {% for row in TABLEDATA %}['{{row.name}}' {% for i in range(20) %},0{% endfor %} ],{% endfor %}
        ]
    },
    axis: {
        x: {
            show:false
        }
    },
});

function updateData(a)
{
	$.get("perValue2?task_code={{TASK_CODE}}", function(data, status){
	    var message = JSON.parse(data);
	    var arr = [0,0,0,0,0,0];
	    for (var i = 0; i < message.data.length; i++) {
            arr[i] = (message.data)[i].value;
        }

        chart.flow({
            columns: [
                ['x', a],
	            {% for i in range(TABLEDATA|length) %}['{{TABLEDATA[i].name}}',arr[{{i}}]],{% endfor %}
            ],
	        duration:1000,
	        done:function(){
                chart.xgrids.add([{value: a, text:message.time,class:'hoge'}]);
                setTimeout(function () {
                    updateData(a+1);
                },0);
    	    }
	    });

    });
}
updateData(20);


</script>
{% include "static/view/tail.html" %}
{% endblock %}
